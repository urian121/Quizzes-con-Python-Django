<div>
  <div class="flex items-center gap-4 px-4">
    <div class="flex-1 flex gap-1">
      {% for _ in segments %}
        <span class="h-2 flex-1 rounded-full {% if forloop.counter <= current_index %}bg-blue-600{% else %}bg-blue-100{% endif %}"></span>
      {% endfor %}
    </div>
    <div class="flex items-center gap-3 text-sm">
      <span class="text-slate-600">{{ current_index }}/{{ total_questions }}</span>
      <span class="rounded-full bg-red-100 text-red-700 px-2 py-1">× {{ wrong_count }}</span>
      <span class="rounded-full bg-green-100 text-green-700 px-2 py-1">✓ {{ correct_count }}</span>
    </div>
  </div>

  <section class="mt-8 px-4">
    <div class="flex items-baseline gap-3">
      <span class="text-slate-500">{{ current_index }}.</span>
      <h2 class="text-xl font-semibold text-slate-900">{{ current_question.pregunta }}</h2>
    </div>

    <form id="quizForm" class="mt-6" hx-post="/quiz/submit" hx-target="#quiz" hx-swap="innerHTML">
      {% csrf_token %}
      <input type="hidden" name="q" value="{{ current_index }}">
      <fieldset class="space-y-3">
        <legend class="sr-only">Opciones</legend>
        {% for item in current_options %}
        <label for="q{{ current_index }}-opt{{ forloop.counter0 }}" class="group flex items-center gap-3 rounded-2xl bg-slate-100 hover:bg-slate-200 px-4 py-3 cursor-pointer">
          <input type="radio" id="q{{ current_index }}-opt{{ forloop.counter0 }}" name="option" value="{{ item.text }}" class="sr-only peer" {% if selected_answer == item.text %}checked{% endif %} />
          <span class="w-8 h-8 rounded-md bg-slate-200 group-hover:bg-slate-300 peer-checked:bg-blue-600 peer-checked:text-white flex items-center justify-center font-medium text-slate-800">{{ item.label }}</span>
          <span class="text-slate-900 peer-checked:font-semibold">{{ item.text }}</span>
        </label>
        {% endfor %}
      </fieldset>

      <div class="mt-8 flex items-center justify-between">
        {% if current_index > 1 %}
          <button type="button" hx-get="/quiz/question?q={{ current_index|add:'-1' }}" hx-target="#quiz" hx-swap="innerHTML" class="rounded-full bg-slate-100 text-slate-900 px-4 py-2 hover:cursor-pointer">Atrás</button>
        {% else %}
          <span class="rounded-full bg-slate-200 text-slate-600 px-4 py-2">Atrás</span>
        {% endif %}
        {% if not at_end %}
          <button type="submit" id="nextBtn" class="rounded-full bg-blue-600 text-white px-5 py-2 hover:cursor-pointer">Siguiente</button>
        {% else %}
          <button type="button" hx-get="/quiz/results" hx-target="#quiz" hx-swap="innerHTML" class="rounded-full bg-blue-600 text-white px-5 py-2 hover:cursor-pointer">Ver resultados</button>
        {% endif %}
      </div>
    </form>
  </section>
</div>
